<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home</title>
    <link rel="icon" href="logo.jpeg" />
    <link rel="stylesheet" type="text/css" href="css.css" />
  </head>

  <body>
    <div>
      <div>
        <p id="googlabel" style="color:white;">Google something:</p>
        <textarea
          style="resize:none; width:250px; height: 30px;"
          id="googlein"
        ></textarea>
      </div>
    </div>
    <div id="container">
      <div id="animate">
        <p id="pos1" style="color:white;left:35%" class="centered animate">
          Youtube
        </p>
        <p id="pos0" style="color:white;left:50%" class="centered animate">
          Vscode
        </p>
        <p id="pos2" style="color:white;left:65%" class="centered animate">
          Webfiles
        </p>
        <p id="pos3" style="color:white;opacity: 0%;">test</p>
      </div>
      <br />
      <button
        id="but1"
        style="width:10%; left:35%"
        class="centered buttonaction"
        onclick="relaydisplay(-1)"
      >
        Previous
      </button>
      <button
        id="but0"
        style="width:10%; left:50%"
        class="centered buttonaction"
        onclick="query()"
      ></button>
      <button
        id="but3"
        style="width:10%; left:50%"
        class="centered buttonaction"
        onclick="query(1)"
      >
        Open in new tab
      </button>
      <button
        id="but2"
        style="width:10%; left:65%;"
        class="centered buttonaction"
        onclick="relaydisplay(1)"
      >
        Next
      </button>
    </div>
    <div id="bookmarks">
      <p></p>
      <button onclick="login(0,1)">Sign in</button>
      <button onclick="login(1,1)">Sign out</button>
    </div>
    <p id="soncole" style="color:white;">Guest</p>
    <script>
      var users = ["Olive", "test", "Guest", "MrFinschleister", "Sophie"];
      var userlevel = [3, 1, 0, 1, 3];
      var optionshref = [
        "https://gmail.com",
        "https://cybermine2098.github.io/webfiles/index.html",
        "https://github.com",
        "https://classroom.google.com",
        "https://youtube.com/@cybermine2098",
        "https://jf-home.v4vi.dev",
        "https://v4vi.dev",
        "https://docs.google.com",
        "https://sheets.google.com",
        "https://google.com",
        "https://https://www.nytimes.com/crosswords"
      ];
      var options = [
        "Gmail",
        "Webfiles",
        "Github",
        "classroom",
        "@cyber",
        "Jellyfin",
        "v4",
        "Gdocs",
        "Gsheets",
        "google",
        "NYT"
      ];
      var reqauth = [0, 0, 1, 0, 1, 3, 2, 0, 0, 0, 0];
      var currauth;
      var optionsindx = 0;
      var coloropt = 1;
      if (users.includes(localStorage.getItem("user"))) {
        currauth = userlevel[users.indexOf(localStorage.getItem("user"))];
      } else {
        currauth = 0;
      }
      function sleep(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }
      function google() {
        let queryS = document
          .getElementById("googlein")
          .value.replace(/ /g, "+");
        window.location.replace(
          "https://www.google.com/search?q=" +
            queryS +
            "&sourceid=chrome&ie=UTF-8&safe=active&ssui=on&surl=1"
        );
      }
      function gotosite(url) {
        window.location.replace(url);
      }
      async function sleepfor(direction) {
        //basically the animation script.. not fun
        FPtextTP("pos3", direction);
        document.getElementById("pos3").style.opacity = "100%";
        let E1 = document.getElementById("pos1");
        let E2 = document.getElementById("pos0");
        let E3 = document.getElementById("pos2");
        let E4 = document.getElementById("pos3");
        let NS1 = Number(
          document.getElementById("pos1").style.left.slice(0, 2)
        );
        let NS2 = Number(
          document.getElementById("pos0").style.left.slice(0, 2)
        );
        let NS3 = Number(
          document.getElementById("pos2").style.left.slice(0, 2)
        );
        let NS4;
        if (direction == 1) {
          NS4 = Number(document.getElementById("pos1").style.left.slice(0, 2));
          NS4 = NS4 - 15;
        } else {
          NS4 = Number(document.getElementById("pos2").style.left.slice(0, 2));
          NS4 = NS4 + 15;
        }
        for (let g = 30; g >= 0; g--) {
          //element settings
          if (direction == 1) {
            if (coloropt == 1) {
              E1.style.color =
                "rgb(" + (255 - g * 12.75) + "," + 255 + "," + 255 + ")";
              E2.style.color =
                "rgb(" + g * 12.75 + "," + g * 4 + "," + 255 + ")";
            } else {
              E1.style.color = "rgb(" + 0 + "," + 0 + "," + 0 + ")";
              E2.style.color = "rgb(" + 0 + "," + 0 + "," + 0 + ")";
            }
            E3.style.opacity = 100 - g * 5 + "%";
            E4.style.opacity = g * 5 + "%";
          }
          if (direction == -1) {
            if (coloropt == 1) {
              E1.style.color =
                "rgb(" + (255 - g * 12.75) + "," + 255 + "," + 255 + ")";
              E2.style.color =
                "rgb(" + g * 12.75 + "," + g * 4 + "," + 255 + ")";
            } else {
              E1.style.color = "rgb(" + 0 + "," + 0 + "," + 0 + ")";
              E2.style.color = "rgb(" + 0 + "," + 0 + "," + 0 + ")";
            }
            E1.style.opacity = 100 - g * 5 + "%";
            E4.style.opacity = g * 5 + "%";
          }
          E1.style.left = NS1 + (g / 2) * direction + "%";
          E2.style.left = NS2 + (g / 2) * direction + "%";
          E3.style.left = NS3 + (g / 2) * direction + "%";
          E4.style.left = NS4 + (g / 2) * direction + "%";
          if (g == 0) {
            E1.style.left = "35%";
            E2.style.left = "50%";
            E3.style.left = "65%";
            E4.style.left = "0%";
          }
          await sleep(5).then(() => {});
        }
      }
      function relaydisplay(direction) {
        optionsindx = optionsindx + direction;
        sleepfor(direction);
      }
      //Find proper text to push
      function FPtextTP(id, vector) {
        let E1 = document.getElementById(id);
        if (vector == 1) {
          if (optionsindx == 0) {
            E1.innerHTML = options[options.length - 2];
          } else if (optionsindx == 1) {
            E1.innerHTML = options[options.length - 1];
          } else {
            E1.innerHTML = options[optionsindx - 2];
          }
        } else {
          if (optionsindx == -1) {
            E1.innerHTML = options[1];
          } else if (optionsindx == options.length-2) {
            E1.innerHTML = options[0];
          } else {
            E1.innerHTML = options[optionsindx + 2];
          }
        }
      }
      //finds correct text to display on the scrollbar
      function pushtext() {
        document.getElementById("pos0").innerHTML = options[optionsindx];
        document.getElementById("but3").innerHTML =
          "Req:" + reqauth[optionsindx] + " | Has: " + currauth;
        if (optionsindx == 0) {
          document.getElementById("pos1").innerHTML =
            options[options.length - 1];
          document.getElementById("pos2").innerHTML = options[optionsindx + 1];
        } else if (optionsindx == options.length - 1) {
          document.getElementById("pos2").innerHTML = options[0];
          document.getElementById("pos1").innerHTML = options[optionsindx - 1];
        } else {
          document.getElementById("pos1").innerHTML = options[optionsindx - 1];
          document.getElementById("pos2").innerHTML = options[optionsindx + 1];
        }
        if (localStorage.getItem("user") != undefined){
          document.getElementById("soncole").innerHTML = "Hi "+localStorage.getItem("user")+"!";
        }else{
          document.getElementById("soncole").innerHTML = "Hello guest";

        }

      }
      function errorfix(showdisp) {
        if (showdisp == 1) {
          alert("function did run");
        }
        if (optionsindx < 0) {
          optionsindx = options.length - 1;
        }
        if (optionsindx > options.length - 1) {
          optionsindx = 0;
        }
        pushtext();
        document.getElementById("but0").innerHTML =
          optionsindx + 1 + "/" + options.length;
      }
      loop();
      function loop() {
        document.onkeydown = checkKey;
        errorfix(0);
        sleep(1).then(() => {
          loop();
        });
      }
      function query(tab) {
        if (currauth >= reqauth[optionsindx]) {
          if (tab == 1) {
            window.open(optionshref[optionsindx], "_blank");
          } else {
            window.location.replace(optionshref[optionsindx]);
          }
        } else {
          alert("You don't have the permission to do this!");
        }
      }
      function checkKey(e) {
        e = e || window.event;
        if (e.keyCode == "38") {
          query(0); //up arrow
        } else if (e.keyCode == "40") {
          query(1); //down arrow
        } else if (e.keyCode == "37") {
          relaydisplay(-1); // left arrow
        } else if (e.keyCode == "39") {
          relaydisplay(1); // right arrow
        } else if (e.key == 187) {
          //equals
          login(0, 1);
        } else if (e.key == "Enter") {
          if (document.getElementById("googlein").value != "") {
            google(); //if there's something to google, it does.
          } else {
            query(); //else it doesn't.
          }
        } else if (e.keyCode == "220") {
          window.location.replace("https://aspen.cps.edu"); //backslash \ <- this one
        }
      }
      function login(logout, notify) {
        if (logout == 1) {
          let inlog = localStorage.getItem("user");
          localStorage.removeItem("user");
          if (inlog != undefined && notify == 1) {
            alert("logged out!");
          }
          currauth = 0;
        } else {
          //runs login code
          let saveduser = localStorage.getItem("user");
          if (saveduser == undefined) {
            let userN = prompt("Username");
            if (userN == "list"){
              alert(users)
              alert("backslash = aspen, enter = google or go to site, tilde = duplicate tab")
              login(1,0)
            }else{
            localStorage.setItem("user", userN);
            currauth = userlevel[users.indexOf(userN)];
          }
          } else {
            currauth = userlevel[users.indexOf(saveduser)];
          }
        }
      }
    </script>
  </body>
</html>